{% extends "auctions/layout.html" %}

{% block title %}
    {{ listing.title }}
{% endblock %}

{% block body %}
    <!-- TODO SHOW USER WHO BOUGHT ITEM THEY WON LISTING -->
    <!-- {% if not listing.is_active %}
        {% if userwonclosedbidding %}
            <div>You bought this item</div>
        {% endif %}
    {% endif %} -->

    <div id="listing-info">
        <div>
            <img src="{{ listing.image_URL }}" alt="Object on display">
            <p>Created by: {{ listing.user }}</p>
            <p>Category: {{ listing.category }}</p>
        </div>
        <div>
            <h2>{{ listing.title }}</h2>
            <p>Description: {{ listing.description }}</p>
            <p>Current Price: {{ listing.price }}</p>

            {% if user.is_authenticated %}
                <form action="#" id="bidform">
                    <label for="bidarea">Bid: <input type="number" name="bid" id="bidarea" placeholder="Ammount" min="0" step="0.01" required></label>
                    <input type="submit" value="Submit Bid" class="">
                </form>
                <a href="{% url 'wishlist' listing.id %}" class="btn btn-secondary">{{ wishlist }}</a>
            {% endif %}

        </div>
             <!-- TODO CLOSE LISTING BY THE CREATOR OF THE LISTING -->
            <!-- {% if user.is_authenticated and user == listing.user %}
                <a href="#" class="">Close auction</a>
            {% endif %} -->
            <!-- check if listing displays always the listing creator or authenticated user -->
    </div>

    <div id="comment-section">
        <h2>Comments:</h2>
        {% for comment in comments %}
        <div class="comment">
            <h3>{{comment.user_name}} said:</h3>
            <p>{{ comment.comment }}</p>
        </div>
        {% empty %}
            <h3>No comments yet.</h3>
        {% endfor %}
    </div>

    {% if user.is_authenticated %}
        <form action="{% url 'commenting' listing.id %}" method="POST" id="comment-form">
            {% csrf_token %}
            {{ commentForm }}
            <input type="submit" value="Submit Comment" class="btn btn-primary">
        </form>
    {% else %}
        <div class="alert alert-info" role="alert"><a href="{% url 'login' %}">Sign in</a> to leave a comment!</div>
    {% endif %}
{% endblock %}